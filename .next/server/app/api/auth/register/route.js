"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/register/route";
exports.ids = ["app/api/auth/register/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_WPS_rss_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/register/route.ts */ \"(rsc)/./app/api/auth/register/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/register/route\",\n        pathname: \"/api/auth/register\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/register/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\WPS\\\\rss抓取\\\\app\\\\api\\\\auth\\\\register\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_WPS_rss_app_api_auth_register_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/register/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGcmVnaXN0ZXIlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZyZWdpc3RlciUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNXUFMlNUNyc3MlRTYlOEElOTMlRTUlOEYlOTYlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q1dQUyU1Q3JzcyVFNiU4QSU5MyVFNSU4RiU5NiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNTO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcnNzLWFpLWRpZ2VzdC8/Zjk5MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxXUFNcXFxccnNz5oqT5Y+WXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxyZWdpc3RlclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvcmVnaXN0ZXJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxXUFNcXFxccnNz5oqT5Y+WXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxyZWdpc3RlclxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL3JlZ2lzdGVyL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/register/route.ts":
/*!****************************************!*\
  !*** ./app/api/auth/register/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n\n\nasync function POST(request) {\n    try {\n        const { username, password } = await request.json();\n        // 验证输入\n        if (!username || !password) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"用户名和密码不能为空\"\n            }, {\n                status: 400\n            });\n        }\n        if (username.length < 3 || username.length > 20) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"用户名长度必须在 3-20 个字符之间\"\n            }, {\n                status: 400\n            });\n        }\n        if (password.length < 6) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"密码长度至少为 6 个字符\"\n            }, {\n                status: 400\n            });\n        }\n        // 创建用户\n        const result = await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.createUser)(username, password);\n        if (!result.success) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: result.error\n            }, {\n                status: 400\n            });\n        }\n        // 生成 Token\n        const token = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.generateToken)(result.userId, username);\n        // 设置 Cookie\n        const response = next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            userId: result.userId,\n            username\n        });\n        response.cookies.set(\"auth_token\", token, {\n            httpOnly: true,\n            secure: \"development\" === \"production\",\n            sameSite: \"lax\",\n            maxAge: 60 * 60 * 24 * 30\n        });\n        return response;\n    } catch (error) {\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"注册失败：\" + error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvcmVnaXN0ZXIvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXdEO0FBQ0Q7QUFFaEQsZUFBZUcsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLE1BQU0sRUFBRUMsUUFBUSxFQUFFQyxRQUFRLEVBQUUsR0FBRyxNQUFNRixRQUFRRyxJQUFJO1FBRWpELE9BQU87UUFDUCxJQUFJLENBQUNGLFlBQVksQ0FBQ0MsVUFBVTtZQUMxQixPQUFPTixrRkFBWUEsQ0FBQ08sSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFhLEdBQ3RCO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxJQUFJSixTQUFTSyxNQUFNLEdBQUcsS0FBS0wsU0FBU0ssTUFBTSxHQUFHLElBQUk7WUFDL0MsT0FBT1Ysa0ZBQVlBLENBQUNPLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBc0IsR0FDL0I7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLElBQUlILFNBQVNJLE1BQU0sR0FBRyxHQUFHO1lBQ3ZCLE9BQU9WLGtGQUFZQSxDQUFDTyxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO1lBQWdCLEdBQ3pCO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPO1FBQ1AsTUFBTUUsU0FBUyxNQUFNVixxREFBVUEsQ0FBQ0ksVUFBVUM7UUFFMUMsSUFBSSxDQUFDSyxPQUFPQyxPQUFPLEVBQUU7WUFDbkIsT0FBT1osa0ZBQVlBLENBQUNPLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU9HLE9BQU9ILEtBQUs7WUFBQyxHQUN0QjtnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsV0FBVztRQUNYLE1BQU1JLFFBQVFYLHdEQUFhQSxDQUFDUyxPQUFPRyxNQUFNLEVBQUdUO1FBRTVDLFlBQVk7UUFDWixNQUFNVSxXQUFXZixrRkFBWUEsQ0FBQ08sSUFBSSxDQUFDO1lBQ2pDSyxTQUFTO1lBQ1RFLFFBQVFILE9BQU9HLE1BQU07WUFDckJUO1FBQ0Y7UUFFQVUsU0FBU0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsY0FBY0osT0FBTztZQUN4Q0ssVUFBVTtZQUNWQyxRQUFRQyxrQkFBeUI7WUFDakNDLFVBQVU7WUFDVkMsUUFBUSxLQUFLLEtBQUssS0FBSztRQUN6QjtRQUVBLE9BQU9QO0lBQ1QsRUFBRSxPQUFPUCxPQUFZO1FBQ25CLE9BQU9SLGtGQUFZQSxDQUFDTyxJQUFJLENBQ3RCO1lBQUVDLE9BQU8sVUFBVUEsTUFBTWUsT0FBTztRQUFDLEdBQ2pDO1lBQUVkLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcnNzLWFpLWRpZ2VzdC8uL2FwcC9hcGkvYXV0aC9yZWdpc3Rlci9yb3V0ZS50cz80YThhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgY3JlYXRlVXNlciwgZ2VuZXJhdGVUb2tlbiB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHVzZXJuYW1lLCBwYXNzd29yZCB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcblxyXG4gICAgLy8g6aqM6K+B6L6T5YWlXHJcbiAgICBpZiAoIXVzZXJuYW1lIHx8ICFwYXNzd29yZCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogXCLnlKjmiLflkI3lkozlr4bnoIHkuI3og73kuLrnqbpcIiB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh1c2VybmFtZS5sZW5ndGggPCAzIHx8IHVzZXJuYW1lLmxlbmd0aCA+IDIwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiBcIueUqOaIt+WQjemVv+W6puW/hemhu+WcqCAzLTIwIOS4quWtl+espuS5i+mXtFwiIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBhc3N3b3JkLmxlbmd0aCA8IDYpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IFwi5a+G56CB6ZW/5bqm6Iez5bCR5Li6IDYg5Liq5a2X56ymXCIgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDliJvlu7rnlKjmiLdcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKTtcclxuXHJcbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiByZXN1bHQuZXJyb3IgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnlJ/miJAgVG9rZW5cclxuICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVUb2tlbihyZXN1bHQudXNlcklkISwgdXNlcm5hbWUpO1xyXG5cclxuICAgIC8vIOiuvue9riBDb29raWVcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICB1c2VySWQ6IHJlc3VsdC51c2VySWQsXHJcbiAgICAgIHVzZXJuYW1lLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzcG9uc2UuY29va2llcy5zZXQoXCJhdXRoX3Rva2VuXCIsIHRva2VuLCB7XHJcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIixcclxuICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXHJcbiAgICAgIG1heEFnZTogNjAgKiA2MCAqIDI0ICogMzAsIC8vIDMwIOWkqVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogXCLms6jlhozlpLHotKXvvJpcIiArIGVycm9yLm1lc3NhZ2UgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlVXNlciIsImdlbmVyYXRlVG9rZW4iLCJQT1NUIiwicmVxdWVzdCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJsZW5ndGgiLCJyZXN1bHQiLCJzdWNjZXNzIiwidG9rZW4iLCJ1c2VySWQiLCJyZXNwb25zZSIsImNvb2tpZXMiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInByb2Nlc3MiLCJzYW1lU2l0ZSIsIm1heEFnZSIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/register/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   generateToken: () => (/* binding */ generateToken),\n/* harmony export */   getAllActiveUsers: () => (/* binding */ getAllActiveUsers),\n/* harmony export */   getCurrentUserFromCookie: () => (/* binding */ getCurrentUserFromCookie),\n/* harmony export */   verifyToken: () => (/* binding */ verifyToken),\n/* harmony export */   verifyUser: () => (/* binding */ verifyUser)\n/* harmony export */ });\n/* harmony import */ var _vercel_kv__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @vercel/kv */ \"(rsc)/./node_modules/@vercel/kv/dist/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"(rsc)/./node_modules/jsonwebtoken/index.js\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n\n\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\";\n/**\r\n * 创建新用户\r\n */ async function createUser(username, password) {\n    try {\n        // 检查用户名是否已存在\n        const existingUser = await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.get(`user:username:${username}`);\n        if (existingUser) {\n            return {\n                success: false,\n                error: \"用户名已存在\"\n            };\n        }\n        // 生成用户 ID\n        const userId = `user_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n        // 加密密码\n        const passwordHash = await bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hash(password, 10);\n        // 创建用户对象\n        const user = {\n            id: userId,\n            username,\n            passwordHash,\n            createdAt: new Date().toISOString()\n        };\n        // 存储用户数据（两个索引：按 ID 和按用户名）\n        await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.set(`user:id:${userId}`, user);\n        await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.set(`user:username:${username}`, user);\n        // 将用户 ID 加入活跃用户列表\n        await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.sadd(\"users:active\", userId);\n        return {\n            success: true,\n            userId\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\n/**\r\n * 验证用户登录\r\n */ async function verifyUser(username, password) {\n    try {\n        const user = await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.get(`user:username:${username}`);\n        if (!user) {\n            return {\n                success: false,\n                error: \"用户名或密码错误\"\n            };\n        }\n        const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].compare(password, user.passwordHash);\n        if (!isValid) {\n            return {\n                success: false,\n                error: \"用户名或密码错误\"\n            };\n        }\n        return {\n            success: true,\n            user\n        };\n    } catch (error) {\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n}\n/**\r\n * 生成 JWT Token\r\n */ function generateToken(userId, username) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().sign({\n        userId,\n        username\n    }, JWT_SECRET, {\n        expiresIn: \"30d\"\n    });\n}\n/**\r\n * 验证 JWT Token\r\n */ function verifyToken(token) {\n    try {\n        const decoded = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default().verify(token, JWT_SECRET);\n        return decoded;\n    } catch  {\n        return null;\n    }\n}\n/**\r\n * 获取所有活跃用户 ID 列表\r\n */ async function getAllActiveUsers() {\n    try {\n        const userIds = await _vercel_kv__WEBPACK_IMPORTED_MODULE_2__.kv.smembers(\"users:active\");\n        return userIds;\n    } catch  {\n        return [];\n    }\n}\n/**\r\n * 从请求的 Cookie 中获取当前用户\r\n */ function getCurrentUserFromCookie(cookieHeader) {\n    if (!cookieHeader) return null;\n    const cookies = cookieHeader.split(\";\").map((c)=>c.trim());\n    const authCookie = cookies.find((c)=>c.startsWith(\"auth_token=\"));\n    if (!authCookie) return null;\n    const token = authCookie.split(\"=\")[1];\n    return verifyToken(token);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFBTUMsVUFBVUQsYUFBYUUsS0FBSyxDQUFDLEtBQUtDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsSUFBSTtJQUN2RCxNQUFNQyxhQUFhTCxRQUFRTSxJQUFJLENBQUNILENBQUFBLElBQUtBLEVBQUVJLFVBQVUsQ0FBQztJQUVsRCxJQUFJLENBQUNGLFlBQVksT0FBTztJQUV4QixNQUFNYixRQUFRYSxXQUFXSixLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7SUFDdEMsT0FBT1YsWUFBWUM7QUFDckIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yc3MtYWktZGlnZXN0Ly4vbGliL2F1dGgudHM/YmY3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBrdiB9IGZyb20gXCJAdmVyY2VsL2t2XCI7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XHJcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5cclxuY29uc3QgSldUX1NFQ1JFVCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgfHwgXCJ5b3VyLXNlY3JldC1rZXktY2hhbmdlLWluLXByb2R1Y3Rpb25cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB1c2VybmFtZTogc3RyaW5nO1xyXG4gIHBhc3N3b3JkSGFzaDogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICog5Yib5bu65paw55So5oi3XHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlVXNlcih1c2VybmFtZTogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IHVzZXJJZD86IHN0cmluZzsgZXJyb3I/OiBzdHJpbmcgfT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyDmo4Dmn6XnlKjmiLflkI3mmK/lkKblt7LlrZjlnKhcclxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IGt2LmdldDxVc2VyPihgdXNlcjp1c2VybmFtZToke3VzZXJuYW1lfWApO1xyXG4gICAgaWYgKGV4aXN0aW5nVXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwi55So5oi35ZCN5bey5a2Y5ZyoXCIgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyDnlJ/miJDnlKjmiLcgSURcclxuICAgIGNvbnN0IHVzZXJJZCA9IGB1c2VyXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyl9YDtcclxuXHJcbiAgICAvLyDliqDlr4blr4bnoIFcclxuICAgIGNvbnN0IHBhc3N3b3JkSGFzaCA9IGF3YWl0IGJjcnlwdC5oYXNoKHBhc3N3b3JkLCAxMCk7XHJcblxyXG4gICAgLy8g5Yib5bu655So5oi35a+56LGhXHJcbiAgICBjb25zdCB1c2VyOiBVc2VyID0ge1xyXG4gICAgICBpZDogdXNlcklkLFxyXG4gICAgICB1c2VybmFtZSxcclxuICAgICAgcGFzc3dvcmRIYXNoLFxyXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8g5a2Y5YKo55So5oi35pWw5o2u77yI5Lik5Liq57Si5byV77ya5oyJIElEIOWSjOaMieeUqOaIt+WQje+8iVxyXG4gICAgYXdhaXQga3Yuc2V0KGB1c2VyOmlkOiR7dXNlcklkfWAsIHVzZXIpO1xyXG4gICAgYXdhaXQga3Yuc2V0KGB1c2VyOnVzZXJuYW1lOiR7dXNlcm5hbWV9YCwgdXNlcik7XHJcblxyXG4gICAgLy8g5bCG55So5oi3IElEIOWKoOWFpea0u+i3g+eUqOaIt+WIl+ihqFxyXG4gICAgYXdhaXQga3Yuc2FkZChcInVzZXJzOmFjdGl2ZVwiLCB1c2VySWQpO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHVzZXJJZCB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOmqjOivgeeUqOaIt+eZu+W9lVxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeVVzZXIodXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8eyBzdWNjZXNzOiBib29sZWFuOyB1c2VyPzogVXNlcjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQga3YuZ2V0PFVzZXI+KGB1c2VyOnVzZXJuYW1lOiR7dXNlcm5hbWV9YCk7XHJcbiAgICBcclxuICAgIGlmICghdXNlcikge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwi55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vXCIgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmRIYXNoKTtcclxuICAgIFxyXG4gICAgaWYgKCFpc1ZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCLnlKjmiLflkI3miJblr4bnoIHplJnor69cIiB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHVzZXIgfTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDnlJ/miJAgSldUIFRva2VuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVUb2tlbih1c2VySWQ6IHN0cmluZywgdXNlcm5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIGp3dC5zaWduKHsgdXNlcklkLCB1c2VybmFtZSB9LCBKV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogXCIzMGRcIiB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIOmqjOivgSBKV1QgVG9rZW5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlUb2tlbih0b2tlbjogc3RyaW5nKTogeyB1c2VySWQ6IHN0cmluZzsgdXNlcm5hbWU6IHN0cmluZyB9IHwgbnVsbCB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBKV1RfU0VDUkVUKSBhcyB7IHVzZXJJZDogc3RyaW5nOyB1c2VybmFtZTogc3RyaW5nIH07XHJcbiAgICByZXR1cm4gZGVjb2RlZDtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOiOt+WPluaJgOaciea0u+i3g+eUqOaItyBJRCDliJfooahcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxBY3RpdmVVc2VycygpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHVzZXJJZHMgPSBhd2FpdCBrdi5zbWVtYmVycyhcInVzZXJzOmFjdGl2ZVwiKTtcclxuICAgIHJldHVybiB1c2VySWRzIGFzIHN0cmluZ1tdO1xyXG4gIH0gY2F0Y2gge1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIOS7juivt+axgueahCBDb29raWUg5Lit6I635Y+W5b2T5YmN55So5oi3XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXJGcm9tQ29va2llKGNvb2tpZUhlYWRlcjogc3RyaW5nIHwgbnVsbCk6IHsgdXNlcklkOiBzdHJpbmc7IHVzZXJuYW1lOiBzdHJpbmcgfSB8IG51bGwge1xyXG4gIGlmICghY29va2llSGVhZGVyKSByZXR1cm4gbnVsbDtcclxuICBcclxuICBjb25zdCBjb29raWVzID0gY29va2llSGVhZGVyLnNwbGl0KCc7JykubWFwKGMgPT4gYy50cmltKCkpO1xyXG4gIGNvbnN0IGF1dGhDb29raWUgPSBjb29raWVzLmZpbmQoYyA9PiBjLnN0YXJ0c1dpdGgoJ2F1dGhfdG9rZW49JykpO1xyXG4gIFxyXG4gIGlmICghYXV0aENvb2tpZSkgcmV0dXJuIG51bGw7XHJcbiAgXHJcbiAgY29uc3QgdG9rZW4gPSBhdXRoQ29va2llLnNwbGl0KCc9JylbMV07XHJcbiAgcmV0dXJuIHZlcmlmeVRva2VuKHRva2VuKTtcclxufVxyXG4iXSwibmFtZXMiOlsia3YiLCJiY3J5cHQiLCJqd3QiLCJKV1RfU0VDUkVUIiwicHJvY2VzcyIsImVudiIsImNyZWF0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZXhpc3RpbmdVc2VyIiwiZ2V0Iiwic3VjY2VzcyIsImVycm9yIiwidXNlcklkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsInBhc3N3b3JkSGFzaCIsImhhc2giLCJ1c2VyIiwiaWQiLCJjcmVhdGVkQXQiLCJ0b0lTT1N0cmluZyIsInNldCIsInNhZGQiLCJtZXNzYWdlIiwidmVyaWZ5VXNlciIsImlzVmFsaWQiLCJjb21wYXJlIiwiZ2VuZXJhdGVUb2tlbiIsInNpZ24iLCJleHBpcmVzSW4iLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZCIsInZlcmlmeSIsImdldEFsbEFjdGl2ZVVzZXJzIiwidXNlcklkcyIsInNtZW1iZXJzIiwiZ2V0Q3VycmVudFVzZXJGcm9tQ29va2llIiwiY29va2llSGVhZGVyIiwiY29va2llcyIsInNwbGl0IiwibWFwIiwiYyIsInRyaW0iLCJhdXRoQ29va2llIiwiZmluZCIsInN0YXJ0c1dpdGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@vercel","vendor-chunks/@upstash","vendor-chunks/semver","vendor-chunks/bcryptjs","vendor-chunks/crypto-js","vendor-chunks/jsonwebtoken","vendor-chunks/lodash.includes","vendor-chunks/jws","vendor-chunks/jwa","vendor-chunks/lodash.once","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/lodash.isplainobject","vendor-chunks/ms","vendor-chunks/lodash.isstring","vendor-chunks/lodash.isnumber","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/buffer-equal-constant-time"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fregister%2Froute&page=%2Fapi%2Fauth%2Fregister%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fregister%2Froute.ts&appDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CWPS%5Crss%E6%8A%93%E5%8F%96&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();