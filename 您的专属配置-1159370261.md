# 🎉 您的 WPS 多维表格专属配置

**账号**: 1159370261@qq.com  
**生成时间**: 2026-02-04  
**状态**: ✅ 已就绪

---

## 📋 您的配置信息

### API 访问信息
```
用户 ID: 1159370261@qq.com
API Key: wps_1770173096274_b4pz5s
```

### API 接口地址
```
本地测试: http://localhost:3000/api/digest/latest
生产环境: https://your-domain.com/api/digest/latest
```

### 完整访问 URL
```
http://localhost:3000/api/digest/latest?userId=1159370261@qq.com&apiKey=wps_1770173096274_b4pz5s&days=1
```

---

## 🚀 快速开始（3 步完成）

### 第一步：创建多维表格

1. 打开 WPS，创建一个新的**多维表格**（不是普通表格）
2. 创建以下字段（必须完全一致）：

| 字段名 | 字段类型 |
|--------|---------|
| 标题 | 单行文本 |
| 内容 | 多行文本 |
| 摘要 | 多行文本 |
| 来源 | 网址 |
| 分类 | 单行文本 |
| 质量分数 | 数字 |
| 发布时间 | 日期时间 |
| 导入时间 | 日期时间 |

### 第二步：添加 AirScript 脚本

1. 在多维表格中，点击顶部菜单「**脚本**」→「**JS脚本**」→「**新建脚本**」
2. 输入脚本名称：`自动导入RSS简报`
3. 复制 `WPS多维表格AirScript-1159370261专属配置.js` 文件的全部内容
4. 粘贴到脚本编辑器中
5. **重要**：修改 `TABLE_NAME` 为您的实际表格名称
   ```javascript
   TABLE_NAME: 'Sheet1'  // 改为您的表格名称
   ```
6. 点击「**保存**」

### 第三步：测试运行

1. 在脚本编辑器中，点击「**运行**」按钮
2. 选择函数：`testConnection`（先测试连接）
3. 查看输出结果
4. 如果连接成功，再运行：`testImport`（测试导入）
5. 检查多维表格，确认数据已导入

---

## ⏰ 设置定时任务（可选）

如果测试成功，可以设置定时任务：

1. 在脚本编辑器中，点击「**定时任务**」
2. 点击「**新建定时任务**」
3. 配置如下：
   - **任务名称**：自动导入 RSS 简报
   - **执行函数**：`scheduledImport`
   - **执行频率**：每天上午 9:00（或您喜欢的时间）
   - **启用任务**：✅ 勾选
4. 点击「**确定**」

---

## 🔧 配置说明

### 当前配置（本地测试）
```javascript
const CONFIG = {
  API_BASE_URL: 'http://localhost:3000',  // 本地地址
  USER_ID: '1159370261@qq.com',
  API_KEY: 'wps_1770173096274_b4pz5s',
  DAYS: 1,
  TABLE_NAME: 'Sheet1'  // 改为您的表格名称
};
```

### 部署后配置（生产环境）
当您将项目部署到线上后，需要修改 `API_BASE_URL`：
```javascript
API_BASE_URL: 'https://your-domain.com',  // 改为实际域名
```

---

## 📝 可用函数说明

AirScript 中提供了 3 个函数：

### 1. `testConnection()` - 测试连接
- **用途**：测试 API 是否可以访问
- **执行时机**：首次配置时，或修改配置后
- **不会导入数据**，只检查连接

### 2. `testImport()` - 手动导入
- **用途**：手动触发一次数据导入
- **执行时机**：测试或需要立即导入时
- **会实际导入数据**

### 3. `scheduledImport()` - 定时导入
- **用途**：由定时任务自动调用
- **执行时机**：按定时任务设置的时间自动执行
- **推荐用于日常自动化**

---

## ⚠️ 注意事项

### 1. 关于数据来源
- 数据来自您在系统中订阅的 RSS 源
- 如果显示"暂无数据"，请先在网页端配置 RSS 订阅
- 简报通常在每天早上生成

### 2. 关于 API Key
- 您的 API Key 是：`wps_1770173096274_b4pz5s`
- 请妥善保管，不要泄露给他人
- 如果泄露，可以在系统中重新生成

### 3. 关于字段名称
- 多维表格的字段名**必须**与代码中完全一致
- 包括：标题、内容、摘要、来源、分类、质量分数、发布时间、导入时间
- 如果字段名不一致，导入会失败

### 4. 关于去重
- 脚本会根据"标题"字段自动去重
- 已存在的内容不会重复导入
- 可以放心多次运行

---

## 🐛 常见问题

### Q1: 提示"未找到数据表"
**原因**：`TABLE_NAME` 配置错误  
**解决**：将 `TABLE_NAME: 'Sheet1'` 改为您的实际表格名称

### Q2: 提示"API 连接失败"
**原因**：API 地址不可访问  
**解决**：
- 确认本地服务是否启动（`npm run dev`）
- 检查 `API_BASE_URL` 是否正确
- 如果是生产环境，确认域名是否可访问

### Q3: 提示"暂无新数据"
**原因**：还没有简报数据  
**解决**：
1. 先在网页端配置 RSS 订阅
2. 等待每日简报生成（通常在早上）
3. 或手动触发简报生成（如果有该功能）

### Q4: 数据导入不完整
**原因**：字段配置不匹配  
**解决**：
1. 检查字段名是否完全一致
2. 检查字段类型是否正确
3. 查看控制台错误日志

---

## 📊 测试验证

### 测试 1：验证 API Key
在浏览器或命令行中访问：
```
http://localhost:3000/api/digest/latest?userId=1159370261@qq.com&apiKey=wps_1770173096274_b4pz5s
```

应该看到类似输出：
```json
{
  "success": true,
  "data": {
    "totalItems": 0,
    "items": [],
    "message": "暂无数据"
  }
}
```

### 测试 2：在 WPS 中测试
运行 `testConnection()` 函数，应该弹出提示：
```
✅ API 连接成功！
数据条数: 0
```

---

## 📞 技术支持

如果遇到问题：
1. 查看上方的「常见问题」
2. 检查 WPS 控制台的错误日志
3. 确认配置信息是否正确

---

## 🎯 下一步

✅ 配置已完成  
✅ API Key 已生成  
✅ AirScript 代码已准备就绪  

**现在可以开始使用了！** 🚀

建议流程：
1. ✅ 创建多维表格和字段
2. ✅ 复制 AirScript 代码
3. ✅ 运行 `testConnection` 测试连接
4. ✅ 在网页端配置 RSS 订阅
5. ✅ 等待简报生成后运行 `testImport`
6. ✅ 验证数据导入成功
7. ✅ 设置定时任务自动导入

祝使用愉快！ 🎉
